<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="gb2312">
<head>
    <title> </title>
    <meta http-equiv="content-type" c />
    <style type="text/css" media="all">
        #Div_CnLei {border:1px solid #ccc;background:#eee;line-height:100px;text-align:center;position:absolute; z-index:1;}
    </style>
</head>
<body>
<div id="Div_CnLei"   style="width:200px; height:100px; top:0px; left:0px;"></div>

<script type="text/javascript">
    var w3c=(document.getElementById)? true: false;
    var agt=navigator.userAgent.toLowerCase();
    var allowDrag=false;
    var chax;
    var chay;
    var ie = ((agt.indexOf("msie") != -1) && (agt.indexOf("opera") == -1) && (agt.indexOf("omniweb") == -1));

    function IeTrueBody(){
        return (document.compatMode && document.compatMode!="BackCompat")? document.documentElement : document.body
    }

    function allow()
    {
        var curX=event.clientX+IeTrueBody().scrollLeft;
        var curY=event.clientY+IeTrueBody().scrollTop;

        chax=parseInt(curX)-parseInt(document.getElementById("Div_CnLei").style.left);
        chay=parseInt(curY)-parseInt(document.getElementById("Div_CnLei").style.top);
        allowDrag=true;

    }

    function unallow()
    {
        allowDrag=false;
    }


    function getMousePos(e){
        var curX=(!ie)?e.pageX : event.clientX+IeTrueBody().scrollLeft;
        var curY=(!ie)?e.pageY : event.clientY+IeTrueBody().scrollTop;
        if(allowDrag)
        {
            tag=document.getElementById("Div_CnLei");
            tag.style.left=(curX-chax)+"px";
            tag.style.top=(curY-chay)+"px";
        }
    }
    document.body;
</script>
</body>
</html>