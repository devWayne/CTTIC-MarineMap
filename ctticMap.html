<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap -->
    <link rel="stylesheet" href="css/bootstrap.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="http://cdn.bootcss.com/html5shiv/3.7.0/html5shiv.min.js"></script>
    <script src="http://cdn.bootcss.com/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="http://cdn.bootcss.com/jquery/1.10.2/jquery.min.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="javascript/bootstrap.js"></script>
    <script src="javascript/map.js"></script>

    <title>China Marine Map</title>
</head>
<body>

<script>
    var x;
    var y;
    var z = 2;
    var left=0;
    var right=0;
    var up=0;
    var down=0;
    $(function () {



             /*   alert("height"+$(window).height()); //浏览器时下窗口可视区域高度
         alert("width"+$(window).width()); //浏览器时下窗口可视区域宽度*/


       /* var height = $(window).height(); //浏览器时下窗口可视区域高度
        var width = $(window).width(); //浏览器时下窗口可视区域宽度
        var h = Math.round(height / 256);
        var w = Math.round(width / 256);*/


        /*
                初始化地图，缩放比列为3
        */
        for (var i = 0; i < 4; i++) {
            for (var j = 0; j < 4; j++) {
                x=j;
                y=i;
                var image = "<img style='width:100%;height:100%' src='http://map.ctrack.com.cn/UserMapSvr/UM_Maping?version=1.0&type=chart&x=" + x + "&y=" + y + "&z=" + z + "'>";
                $("#pic" + i + "_" + j).append(image);
                //$("#pic" + i + "_" + j).click(big());
            }
        }


        /*
              单击触发放大事件，缩放比例+1
         */
        $(window).bind("click",function(){
            z=z+1;
            var _x=Number((Math.pow(2,(z-1)))/2-2+right-left);
            var _y=Number((Math.pow(2,(z-1)))/2-2-up+down);
            for (var i =0; i < 4; i++) {
                for (var j = 0; j < 4; j++) {
                    x=_x+j;
                    y=_y+i;
                    $("#pic" + i + "_" + j).empty();
                    var image = "<img style='width:100%;height:100%' src='http://map.ctrack.com.cn/UserMapSvr/UM_Maping?version=1.0&type=chart&x=" +x+ "&y=" +y+ "&z=" + z + "'>";
                    $("#pic" + i + "_" + j).append(image);
                    //$("#pic" + i + "_" + j).click(big());
                }
            }
            x=x-4;
            y=y-4;
            $("#getx").attr("value",x/2);
            $("#gety").attr("value",y/2);
            $("#getz").attr("value",z);
        });


        /*
                          键盘触发事件
         */
        $(window).keydown(function(event){

                        //键盘“D”，触发地图向右移动事件
                        if(event.which == 68)
                        {
                            right++;movemap();
                        }

                        //键盘“A”，触发地图向左移动事件
                        if(event.which == 65)
                        {
                            left++;movemap();
                        }

                        //键盘“W”，触发地图向上移动事件
                        if(event.which == 87)
                        {
                            up++;movemap();
                        }

                        //键盘“S”，触发地图向下移动事件
                        if(event.which == 83)
                        {
                            down++;movemap();
                        }

                        //键盘“Q”，触发地图缩小事件，缩放比列-1
                        if(event.which == 81)
                        {
                            z=z-1;
                            var _x=Number((Math.pow(2,(z-1)))/2-2+right-left);
                            var _y=Number((Math.pow(2,(z-1)))/2-2-up+down);
                            for (var i =0; i < 4; i++) {
                                for (var j = 0; j < 4; j++) {
                                    x=_x+j;
                                    y=_y+i;
                                    $("#pic" + i + "_" + j).empty();
                                    var image = "<img style='width:100%;height:100%' src='http://map.ctrack.com.cn/UserMapSvr/UM_Maping?version=1.0&type=chart&x=" +x+ "&y=" +y+ "&z=" + z + "'>";
                                    $("#pic" + i + "_" + j).append(image);
                                    //$("#pic" + i + "_" + j).click(big());
                                }
                            }
                            x=x-4;
                            y=y-4;
                            $("#getx").attr("value",x/2);
                            $("#gety").attr("value",y/2);
                            $("#getz").attr("value",z);
                        }

                        //移动后刷新地图
                        function movemap(){
                            var _x=x;
                            var _y=y;
                                         for (var i = 0; i < 4; i++) {
                                             for (var j = 0; j < 4; j++) {
                                                 x=_x+right-left+j;
                                                 y=_y-up+down+i;
                                                 $("#pic" + i + "_" + j).empty();
                                                 var image = "<img style='width:100%;height:100%' src='http://map.ctrack.com.cn/UserMapSvr/UM_Maping?version=1.0&type=chart&x=" + x + "&y=" + y + "&z=" + z + "'>";
                                                 $("#pic" + i + "_" + j).append(image);
                                                 //$("#pic" + i + "_" + j).click(big());
                                             }
                                         }
                            $("#getx").attr("value",x/2);
                            $("#gety").attr("value",y/2);
                            $("#getz").attr("value",z);
                            x=_x;
                            y=_y;
                            }

         });



    });






</script>

        <div class="row" id="pic">
            <div id="pic0_0" class="col-md-2"> </div>
            <div id="pic0_1" class="col-md-2"> </div>
            <div id="pic0_2" class="col-md-2"> </div>.
            <div id="pic0_3" class="col-md-2"> </div>
            <div class="panel panel-default col-md-2">
                <div class="panel-body">
                              Position Now      </div>
                <div class="panel-footer">
                   X point :<input type="text" id="getx" value="0" disabled="disabled">
                </div>
                <div class="panel-footer">
                   Y point :<input type="text" id="gety" value="0" disabled="disabled">
                </div>
                <div class="panel-footer">
                   Zoom&nbsp;&nbsp; :<input type="text" id="getz" value="0" disabled="disabled">
                </div>
            </div>

        </div>
        <div class="row">
            <div id="pic1_0" class="col-md-2"> </div>
            <div id="pic1_1" class="col-md-2"> </div>
            <div id="pic1_2" class="col-md-2"> </div>
            <div id="pic1_3" class="col-md-2"> </div>
        </div>
        <div class="row">
            <div id="pic2_0" class="col-md-2"> </div>
            <div id="pic2_1" class="col-md-2"> </div>
            <div id="pic2_2" class="col-md-2"> </div>
            <div id="pic2_3" class="col-md-2"> </div>
        </div>
        <div class="row">
            <div id="pic3_0" class="col-md-2"> </div>
            <div id="pic3_1" class="col-md-2"> </div>
            <div id="pic3_2" class="col-md-2"> </div>
            <div id="pic3_3" class="col-md-2"> </div>
        </div>

</body>
</html>